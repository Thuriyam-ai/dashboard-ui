(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[747],{3796:function(e,i,t){Promise.resolve().then(t.bind(t,2026))},2026:function(e,i,t){"use strict";t.r(i),t.d(i,{default:function(){return H}});var a=t(7437),l=t(2265),n=t(9376),s=t(4753),r=t(3397),d=t(8543),o=t(8319),c=t(9083),x=t(5666),h=t(5545),u=t(658),j=t(7639),Z=t(1504),m=t(1563),g=t(8190),p=t(34),v=t(1002),f=t(9352),C=t(1835),y=t(2347),_=t(6425),b=t(9318),S=t(5280),w=t(7554),A=t(2995),T=t(8654),W=t(8045),N=t(6838),E=t(6116),k=t(6382),I=t(6875),z=t(6136),O=t(4763),D=t(7615),M=t(1442),P=t(1617),L=t(2517),F=t(8759),G=t(7823),B=t(4361),U=t(9470),q=t(599),R=t(1637);function K(){let e=(0,n.useRouter)(),i=(0,n.useSearchParams)(),[t,K]=(0,l.useState)(0),[H,Q]=(0,l.useState)(!1),[X,Y]=(0,l.useState)(null),[J,V]=(0,l.useState)(!1),[$,ee]=(0,l.useState)(!0),[ei,et]=(0,l.useState)([]),[ea,el]=(0,l.useState)([]),[en,es]=(0,l.useState)(""),[er,ed]=(0,l.useState)(""),[eo,ec]=(0,l.useState)(""),[ex,eh]=(0,l.useState)(""),[eu,ej]=(0,l.useState)(""),[eZ,em]=(0,l.useState)(""),[eg,ep]=(0,l.useState)([]),[ev,ef]=(0,l.useState)([]),[eC,ey]=(0,l.useState)([]),[e_,eb]=(0,l.useState)([]);(0,l.useEffect)(()=>{(async()=>{try{let[e,t]=await Promise.all([(0,R.Cq)(),(0,R.LK)()]);et(e),el(t);let a=i.get("id"),l=i.get("clone");if(a){Q(!0),Y(a);try{let e=await (0,R.CK)(a,"draft");eS(e)}catch(i){console.log("No draft found, fetching active version to edit.");let e=await (0,R.CK)(a,"active");eS(e)}}else if(l){let e=await (0,R.CK)(l,"active");eS(e),es("".concat(e.name," (Clone)"))}else ef([{name:"Sentiment Analysis",is_enabled:!0,display_order:1},{name:"Intent Extraction",is_enabled:!0,display_order:2},{name:"Emergent Topics Detection",is_enabled:!1,display_order:3}])}catch(i){console.error("Initialization failed:",i),alert("Failed to load goal data for the editor."),e.push("/team-leader-dashboard/goal-mgmt")}finally{ee(!1)}})()},[i,e]);let eS=e=>{es(e.name),ec(e.description||""),ed(e.owner_id),ej(e.team_id||""),eh(e.tags||""),em(e.prompt_text),ep(e.outcomefields.map(e=>({...e,id:Math.random().toString()}))),ef(e.insights),ey(e.dispositions.map(e=>({...e,id:Math.random().toString()}))),eb(e.scorecardparameters.map(e=>({...e,id:Math.random().toString()})))},ew=async()=>{if(!en||!er){alert("Please fill in Goal Name and Owner.");return}V(!0);let i={organization_id:"org-1",owner_id:er,name:en,description:eo,team_id:eu||null,tags:ex,prompt_text:eZ,outcomefields:eg.map((e,i)=>{let{id:t,...a}=e;return{...a,display_order:i+1,configuration:"{}"}}),insights:ev.map((e,i)=>({...e,display_order:i+1})),dispositions:eC.map((e,i)=>{let{id:t,...a}=e;return{...a,description:null,display_order:i+1}}),scorecardparameters:e_.map((e,i)=>{let{id:t,...a}=e;return{...a,display_order:i+1}})};try{H&&X?(await (0,R.qx)(X,i),alert("Goal draft updated successfully!")):(await (0,R.HZ)(i),alert("Goal created successfully!")),e.push("/team-leader-dashboard/goal-mgmt")}catch(e){console.error("Failed to save goal:",e),alert("Error: Could not save the goal.")}finally{V(!1)}},eA=e_.reduce((e,i)=>e+i.max_score,0),eT=(e,i)=>ep(eg.map(t=>t.id===e?{...t,...i}:t)),eW=e=>ep(eg.filter(i=>i.id!==e)),eN=(e,i)=>ey(eC.map(t=>t.id===e?{...t,...i}:t)),eE=e=>ey(eC.filter(i=>i.id!==e)),ek=(e,i)=>eb(e_.map(t=>t.id===e?{...t,...i}:t)),eI=e=>eb(e_.filter(i=>i.id!==e)),ez=(e,i)=>{ef(ev.map(t=>t.name===e?{...t,is_enabled:i}:t))};return $?(0,a.jsx)(d.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,a.jsx)(o.Z,{})}):(0,a.jsxs)(d.Z,{sx:{display:"flex",minHeight:"100vh",backgroundColor:"background.default"},children:[(0,a.jsx)(s.q,{activeItem:"goal-mgmt"}),(0,a.jsxs)(d.Z,{sx:{flexGrow:1,display:"flex",flexDirection:"column",marginLeft:"280px"},children:[(0,a.jsx)(c.Z,{position:"static",elevation:1,sx:{backgroundColor:"background.paper",color:"text.primary"},children:(0,a.jsxs)(x.Z,{children:[(0,a.jsxs)(d.Z,{sx:{display:"flex",alignItems:"center",gap:2,flexGrow:1},children:[(0,a.jsx)(h.Z,{onClick:()=>e.push("/team-leader-dashboard/goal-mgmt"),children:(0,a.jsx)(M.Z,{})}),(0,a.jsxs)(d.Z,{children:[(0,a.jsx)(u.Z,{variant:"h6",fontWeight:600,children:H?"Edit Goal":"Create New Goal"}),(0,a.jsx)(u.Z,{variant:"body2",color:"text.secondary",children:en||"Untitled Goal"})]})]}),(0,a.jsx)(j.Z,{variant:"contained",startIcon:(0,a.jsx)(P.Z,{}),onClick:ew,disabled:J,children:J?"Saving...":"Save Goal"})]})}),(0,a.jsxs)(Z.Z,{maxWidth:"xl",sx:{flexGrow:1,py:3},children:[(0,a.jsx)(r.O,{}),(0,a.jsxs)(m.Z,{sx:{mb:3},children:[(0,a.jsx)(d.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,a.jsxs)(g.Z,{value:t,onChange:(e,i)=>K(i),children:[(0,a.jsx)(p.Z,{icon:(0,a.jsx)(L.Z,{}),label:"Interaction Blueprint",value:0,iconPosition:"start"}),(0,a.jsx)(p.Z,{icon:(0,a.jsx)(F.Z,{}),label:"Structured Data Capture",value:1,iconPosition:"start"}),(0,a.jsx)(p.Z,{icon:(0,a.jsx)(G.Z,{}),label:"Conversation Insights",value:2,iconPosition:"start"}),(0,a.jsx)(p.Z,{icon:(0,a.jsx)(B.Z,{}),label:"Quality Scorecard",value:3,iconPosition:"start"})]})}),(0,a.jsxs)(v.Z,{sx:{p:0,"& .MuiTableCell-root":{p:1}},children:[0===t&&(0,a.jsxs)(d.Z,{sx:{p:3},children:[(0,a.jsx)(u.Z,{variant:"h5",fontWeight:600,gutterBottom:!0,sx:{mb:3},children:"Goal Configuration"}),(0,a.jsxs)(f.Z,{container:!0,spacing:3,children:[(0,a.jsxs)(f.Z,{size:{xs:12,md:6},children:[(0,a.jsx)(C.Z,{fullWidth:!0,label:"Goal Name",value:en,onChange:e=>es(e.target.value),sx:{mb:2},required:!0}),(0,a.jsxs)(y.Z,{fullWidth:!0,sx:{mb:2},required:!0,children:[(0,a.jsx)(_.Z,{children:"Owner"}),(0,a.jsx)(b.Z,{value:er,onChange:e=>ed(e.target.value),label:"Owner",children:ei.map(e=>(0,a.jsx)(S.Z,{value:e.id,children:e.name},e.id))})]}),(0,a.jsx)(C.Z,{fullWidth:!0,label:"Tags",value:ex,onChange:e=>eh(e.target.value),helperText:"Comma-separated tags",sx:{mb:2}})]}),(0,a.jsxs)(f.Z,{size:{xs:12,md:6},children:[(0,a.jsxs)(y.Z,{fullWidth:!0,sx:{mb:2},children:[(0,a.jsx)(_.Z,{children:"Default Assigned Team"}),(0,a.jsxs)(b.Z,{value:eu,onChange:e=>ej(e.target.value),label:"Default Assigned Team",children:[(0,a.jsx)(S.Z,{value:"",children:(0,a.jsx)("em",{children:"None"})}),ea.map(e=>(0,a.jsx)(S.Z,{value:e.id,children:e.name},e.id))]})]}),(0,a.jsx)(C.Z,{fullWidth:!0,multiline:!0,rows:4,label:"Description",value:eo,onChange:e=>ec(e.target.value)})]})]}),(0,a.jsx)(w.Z,{sx:{my:3}}),(0,a.jsx)(u.Z,{variant:"h6",gutterBottom:!0,sx:{mb:2},children:"System Prompt (Interaction Blueprint)"}),(0,a.jsx)(C.Z,{fullWidth:!0,multiline:!0,rows:8,value:eZ,onChange:e=>em(e.target.value)})]}),1===t&&(0,a.jsxs)(d.Z,{sx:{p:3},children:[(0,a.jsxs)(d.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,a.jsx)(u.Z,{variant:"h5",fontWeight:600,children:"Structured Data Capture (Outcome Fields)"}),(0,a.jsx)(j.Z,{variant:"outlined",startIcon:(0,a.jsx)(U.Z,{}),onClick:()=>ep([...eg,{id:Date.now().toString(),attribute_name:"",data_type:"TEXT",elicitation_prompt:"",is_pii:!1,is_required:!1,weight:10}]),children:"Add Field"})]}),(0,a.jsx)(A.Z,{component:T.Z,variant:"outlined",children:(0,a.jsxs)(W.Z,{children:[(0,a.jsx)(N.Z,{children:(0,a.jsxs)(E.Z,{sx:{"& .MuiTableCell-root":{fontWeight:600,backgroundColor:"action.hover"}},children:[(0,a.jsx)(k.Z,{children:"Attribute Name"}),(0,a.jsx)(k.Z,{children:"Data Type"}),(0,a.jsx)(k.Z,{children:"Elicitation Prompt"}),(0,a.jsx)(k.Z,{align:"center",children:"Required"}),(0,a.jsx)(k.Z,{align:"center",children:"PII"}),(0,a.jsx)(k.Z,{children:"Weight"}),(0,a.jsx)(k.Z,{children:"Actions"})]})}),(0,a.jsx)(I.Z,{children:eg.map(e=>(0,a.jsxs)(E.Z,{children:[(0,a.jsx)(k.Z,{children:(0,a.jsx)(C.Z,{size:"small",value:e.attribute_name,onChange:i=>eT(e.id,{attribute_name:i.target.value}),fullWidth:!0})}),(0,a.jsx)(k.Z,{sx:{minWidth:150},children:(0,a.jsx)(y.Z,{size:"small",fullWidth:!0,children:(0,a.jsxs)(b.Z,{value:e.data_type,onChange:i=>eT(e.id,{data_type:i.target.value}),children:[(0,a.jsx)(S.Z,{value:"TEXT",children:"Text"}),(0,a.jsx)(S.Z,{value:"NUMBER",children:"Number"}),(0,a.jsx)(S.Z,{value:"BOOLEAN",children:"Boolean"}),(0,a.jsx)(S.Z,{value:"SELECT",children:"Select"})]})})}),(0,a.jsx)(k.Z,{children:(0,a.jsx)(C.Z,{size:"small",value:e.elicitation_prompt||"",onChange:i=>eT(e.id,{elicitation_prompt:i.target.value}),fullWidth:!0})}),(0,a.jsx)(k.Z,{align:"center",children:(0,a.jsx)(z.Z,{checked:e.is_required,onChange:i=>eT(e.id,{is_required:i.target.checked})})}),(0,a.jsx)(k.Z,{align:"center",children:(0,a.jsx)(z.Z,{checked:e.is_pii,onChange:i=>eT(e.id,{is_pii:i.target.checked})})}),(0,a.jsx)(k.Z,{children:(0,a.jsx)(C.Z,{size:"small",type:"number",value:e.weight,onChange:i=>eT(e.id,{weight:parseInt(i.target.value)||0}),sx:{width:80}})}),(0,a.jsx)(k.Z,{children:(0,a.jsx)(h.Z,{size:"small",color:"error",onClick:()=>eW(e.id),children:(0,a.jsx)(q.Z,{})})})]},e.id))})]})})]}),2===t&&(0,a.jsxs)(d.Z,{sx:{p:3},children:[(0,a.jsx)(u.Z,{variant:"h5",fontWeight:600,gutterBottom:!0,sx:{mb:3},children:"Conversation Insights"}),(0,a.jsxs)(f.Z,{container:!0,spacing:3,children:[(0,a.jsx)(f.Z,{size:{xs:12,md:6},children:(0,a.jsx)(m.Z,{variant:"outlined",children:(0,a.jsxs)(v.Z,{children:[(0,a.jsx)(u.Z,{variant:"h6",gutterBottom:!0,children:"Analytics Models (Insights)"}),(0,a.jsx)(O.Z,{spacing:1,children:ev.map(e=>(0,a.jsx)(D.Z,{control:(0,a.jsx)(z.Z,{checked:e.is_enabled,onChange:i=>ez(e.name,i.target.checked)}),label:e.name},e.name))})]})})}),(0,a.jsx)(f.Z,{size:{xs:12,md:6},children:(0,a.jsx)(m.Z,{variant:"outlined",children:(0,a.jsxs)(v.Z,{children:[(0,a.jsx)(u.Z,{variant:"h6",gutterBottom:!0,children:"Dispositions"}),(0,a.jsxs)(O.Z,{spacing:1.5,children:[eC.map(e=>(0,a.jsxs)(d.Z,{sx:{display:"flex",gap:1,alignItems:"center"},children:[(0,a.jsx)(C.Z,{size:"small",label:"Name",value:e.name,onChange:i=>eN(e.id,{name:i.target.value}),fullWidth:!0}),(0,a.jsxs)(y.Z,{size:"small",sx:{minWidth:120},children:[(0,a.jsx)(_.Z,{children:"Category"}),(0,a.jsxs)(b.Z,{value:e.category,onChange:i=>eN(e.id,{category:i.target.value}),label:"Category",children:[(0,a.jsx)(S.Z,{value:"SUCCESS",children:"Success"}),(0,a.jsx)(S.Z,{value:"FAILURE",children:"Failure"}),(0,a.jsx)(S.Z,{value:"NEUTRAL",children:"Neutral"})]})]}),(0,a.jsx)(h.Z,{color:"error",onClick:()=>eE(e.id),children:(0,a.jsx)(q.Z,{})})]},e.id)),(0,a.jsx)(j.Z,{size:"small",startIcon:(0,a.jsx)(U.Z,{}),onClick:()=>ey([...eC,{id:Date.now().toString(),name:"",category:"NEUTRAL"}]),variant:"outlined",sx:{alignSelf:"flex-start"},children:"Add Disposition"})]})]})})})]})]}),3===t&&(0,a.jsxs)(d.Z,{sx:{p:3},children:[(0,a.jsxs)(d.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,a.jsxs)(d.Z,{children:[(0,a.jsx)(u.Z,{variant:"h5",fontWeight:600,children:"Quality Scorecard"}),(0,a.jsxs)(u.Z,{variant:"body2",color:"text.secondary",children:["Total Score: ",eA," points"]})]}),(0,a.jsx)(j.Z,{variant:"outlined",startIcon:(0,a.jsx)(U.Z,{}),onClick:()=>eb([...e_,{id:Date.now().toString(),name:"",max_score:5,failure_type:"NON_FATAL",scoring_type:"MANUAL",rules_and_explanation:""}]),children:"Add Parameter"})]}),(0,a.jsx)(A.Z,{component:T.Z,variant:"outlined",children:(0,a.jsxs)(W.Z,{children:[(0,a.jsx)(N.Z,{children:(0,a.jsxs)(E.Z,{sx:{"& .MuiTableCell-root":{fontWeight:600,backgroundColor:"action.hover"}},children:[(0,a.jsx)(k.Z,{children:"Parameter Name"}),(0,a.jsx)(k.Z,{children:"Scoring Type"}),(0,a.jsx)(k.Z,{children:"Failure Type"}),(0,a.jsx)(k.Z,{children:"Max Score"}),(0,a.jsx)(k.Z,{sx:{width:"30%"},children:"Rules & Explanation"}),(0,a.jsx)(k.Z,{children:"Actions"})]})}),(0,a.jsx)(I.Z,{children:e_.map(e=>(0,a.jsxs)(E.Z,{children:[(0,a.jsx)(k.Z,{children:(0,a.jsx)(C.Z,{size:"small",value:e.name,onChange:i=>ek(e.id,{name:i.target.value}),fullWidth:!0})}),(0,a.jsx)(k.Z,{sx:{minWidth:180},children:(0,a.jsx)(y.Z,{size:"small",fullWidth:!0,children:(0,a.jsxs)(b.Z,{value:e.scoring_type,onChange:i=>ek(e.id,{scoring_type:i.target.value}),children:[(0,a.jsx)(S.Z,{value:"MANUAL",children:"Manual"}),(0,a.jsx)(S.Z,{value:"AUTO_KEYWORD",children:"Auto Keyword"}),(0,a.jsx)(S.Z,{value:"AUTO_SENTIMENT",children:"Auto Sentiment"}),(0,a.jsx)(S.Z,{value:"AUTO_COMPLETENESS",children:"Auto Completeness"})]})})}),(0,a.jsx)(k.Z,{sx:{minWidth:150},children:(0,a.jsx)(y.Z,{size:"small",fullWidth:!0,children:(0,a.jsxs)(b.Z,{value:e.failure_type,onChange:i=>ek(e.id,{failure_type:i.target.value}),children:[(0,a.jsx)(S.Z,{value:"NON_FATAL",children:"Non-Fatal"}),(0,a.jsx)(S.Z,{value:"FATAL",children:"Fatal"})]})})}),(0,a.jsx)(k.Z,{children:(0,a.jsx)(C.Z,{size:"small",type:"number",value:e.max_score,onChange:i=>ek(e.id,{max_score:parseInt(i.target.value)||0}),sx:{width:80}})}),(0,a.jsx)(k.Z,{children:(0,a.jsx)(C.Z,{size:"small",value:e.rules_and_explanation||"",onChange:i=>ek(e.id,{rules_and_explanation:i.target.value}),fullWidth:!0})}),(0,a.jsx)(k.Z,{children:(0,a.jsx)(h.Z,{size:"small",color:"error",onClick:()=>eI(e.id),children:(0,a.jsx)(q.Z,{})})})]},e.id))})]})})]})]})]})]})]})]})}function H(){return(0,a.jsx)(l.Suspense,{fallback:(0,a.jsx)(d.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,a.jsx)(o.Z,{})}),children:(0,a.jsx)(K,{})})}}},function(e){e.O(0,[334,103,118,362,835,515,59,114,618,971,117,744],function(){return e(e.s=3796)}),_N_E=e.O()}]);