(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[370],{2279:function(e,a,t){Promise.resolve().then(t.bind(t,9643))},9643:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return H}});var n=t(7437),s=t(2265),i=t(9376),r=t(4753),l=t(3397),o=t(8543),c=t(8319),d=t(5338),x=t(658),h=t(7639),u=t(9352),g=t(1563),p=t(1002),m=t(793),Z=t(8343),f=t(9083),j=t(5666),v=t(5545),y=t(2854),b=t(1504),_=t(4247),w=t(3985),C=t(6825),k=t(7893),I=t(5386),z=t(307),W=t(9470),S=t(196),G=t(9010),D=t(1381),A=t(3484),E=t(2961),N=t(8841),F=t(5826),P=t(3274),L=t(599),B=t(2141),q=t(9391),O=t(2192),T=t(4881),Y=t(1637);function H(){let e=(0,i.useRouter)(),[a,t]=(0,s.useState)([]),[H,K]=(0,s.useState)(!0),[X,M]=(0,s.useState)(null),[R,V]=(0,s.useState)(!1),[J,Q]=(0,s.useState)(null),{logout:U}=(0,T.a)(),[$,ee]=(0,s.useState)(null),ea=async()=>{try{K(!0);let e=await (0,Y.aX)();if(0===e.length){t([]);return}let a=e.map(e=>(0,Y.DG)(e.goal_id)),n=await Promise.all(a),s=e.map((e,a)=>({...e,is_editable:n[a]}));t(s),M(null)}catch(e){M("Failed to fetch goals. Please try again later."),console.error(e)}finally{K(!1)}};(0,s.useEffect)(()=>{ea()},[]);let et=async e=>{try{await (0,Y.g3)(e),alert("Draft published successfully!"),await ea()}catch(e){console.error("Failed to publish draft:",e),alert("Error: Could not publish draft.")}},en=async()=>{if(J)try{await (0,Y.s6)(J.goal_id),alert('Goal "'.concat(J.goal_name,'" archived.')),await ea()}catch(e){console.error("Failed to delete goal:",e),alert("Error: Could not delete goal.")}finally{V(!1),Q(null)}},es=()=>e.push("/team-leader-dashboard/goal-mgmt/editor"),ei=a=>e.push("/team-leader-dashboard/goal-mgmt/editor?id=".concat(a)),er=a=>e.push("/team-leader-dashboard/goal-mgmt/editor?clone=".concat(a)),el=e=>{Q(e),V(!0)},eo=a=>e.push("/team-leader-dashboard/goal-mgmt/view?id=".concat(a)),ec=e=>{navigator.clipboard.writeText(e).then(()=>{ee(e),setTimeout(()=>ee(null),2e3)}).catch(e=>{console.error("Failed to copy ID: ",e)})};return(0,n.jsxs)(o.Z,{sx:{display:"flex",minHeight:"100vh",backgroundColor:"background.default"},children:[(0,n.jsx)(r.q,{activeItem:"goal-mgmt"}),(0,n.jsxs)(o.Z,{sx:{flexGrow:1,display:"flex",flexDirection:"column",marginLeft:"280px"},children:[(0,n.jsx)(f.Z,{position:"static",elevation:1,sx:{backgroundColor:"background.paper",color:"text.primary",borderBottom:"1px solid",borderColor:"divider"},children:(0,n.jsxs)(j.Z,{children:[(0,n.jsx)(o.Z,{sx:{flexGrow:1},children:(0,n.jsx)(x.Z,{variant:"body2",sx:{fontFamily:"monospace",color:"text.secondary"},children:"team-leader-dashboard/goal-mgmt"})}),(0,n.jsxs)(o.Z,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,n.jsx)(v.Z,{size:"small",sx:{color:"text.secondary"},children:(0,n.jsx)(B.Z,{})}),(0,n.jsxs)(o.Z,{sx:{display:"flex",alignItems:"center",gap:1,mr:2},children:[(0,n.jsx)(y.Z,{sx:{width:32,height:32,bgcolor:"primary.main",fontSize:"0.875rem"},children:"W"}),(0,n.jsx)(x.Z,{variant:"body2",fontWeight:500,children:"Work"})]}),(0,n.jsx)(v.Z,{size:"small",sx:{color:"text.secondary"},children:(0,n.jsx)(q.Z,{})}),(0,n.jsx)(h.Z,{variant:"contained",color:"error",size:"small",startIcon:(0,n.jsx)(O.Z,{}),sx:{ml:1},onClick:U,children:"Logout"})]})]})}),(0,n.jsxs)(b.Z,{maxWidth:"xl",sx:{flexGrow:1,py:3},children:[(0,n.jsx)(l.O,{}),(0,n.jsx)(o.Z,{sx:{my:4},children:(0,n.jsxs)(o.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,n.jsxs)(o.Z,{children:[(0,n.jsx)(x.Z,{variant:"h4",component:"h1",fontWeight:700,gutterBottom:!0,children:"Goal Management"}),(0,n.jsx)(x.Z,{color:"text.secondary",children:"Create and manage conversation goals for your teams"})]}),(0,n.jsx)(h.Z,{variant:"contained",startIcon:(0,n.jsx)(W.Z,{}),onClick:es,sx:{px:2,py:1},children:"Create New Goal"})]})}),H?(0,n.jsx)(o.Z,{sx:{display:"flex",justifyContent:"center",py:8},children:(0,n.jsx)(c.Z,{})}):X?(0,n.jsx)(d.Z,{severity:"error",children:X}):0===a.length?(0,n.jsxs)(o.Z,{sx:{textAlign:"center",py:8},children:[(0,n.jsx)(z.Z,{sx:{fontSize:80,color:"text.secondary",mb:2}}),(0,n.jsx)(x.Z,{variant:"h5",gutterBottom:!0,children:"No Goals Created Yet"}),(0,n.jsx)(h.Z,{variant:"contained",startIcon:(0,n.jsx)(W.Z,{}),onClick:es,size:"large",children:"Create Your First Goal"})]}):(0,n.jsx)(u.Z,{container:!0,spacing:2,children:a.map(e=>(0,n.jsx)(u.Z,{item:!0,xs:12,children:(0,n.jsx)(g.Z,{onClick:()=>eo(e.goal_id),sx:{cursor:"pointer",transition:"all 0.2s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:4},width:"75vw"},children:(0,n.jsx)(p.Z,{children:(0,n.jsxs)(o.Z,{sx:{display:"flex",alignItems:"center",gap:3,flexWrap:"wrap"},children:[(0,n.jsxs)(o.Z,{sx:{flex:"1 1 50%",minWidth:300},children:[(0,n.jsxs)(o.Z,{sx:{display:"flex",alignItems:"center",gap:1,mb:1,flexWrap:"wrap"},children:[(0,n.jsx)(x.Z,{variant:"h6",fontWeight:600,children:e.goal_name}),(0,n.jsx)(m.Z,{label:"Published: ".concat(null!=e.published_version_no?"v".concat(e.published_version_no):"None"),size:"small",color:"success",icon:(0,n.jsx)(S.Z,{sx:{fontSize:16}})}),(0,n.jsx)(m.Z,{label:"Draft: ".concat(null!=e.draft_version_no?"v".concat(e.draft_version_no):"None"),size:"small",color:"default",icon:(0,n.jsx)(G.Z,{sx:{fontSize:16}})})]}),(0,n.jsx)(x.Z,{variant:"body2",color:"text.secondary",sx:{mb:1.5},children:e.description}),(0,n.jsxs)(x.Z,{variant:"caption",color:"text.secondary",children:["Last updated: ",new Date(e.updated_at).toLocaleDateString()]})]}),(0,n.jsxs)(o.Z,{sx:{flex:"1 1 150px",minWidth:150},children:[(0,n.jsx)(x.Z,{variant:"caption",color:"text.secondary",display:"block",gutterBottom:!0,children:"Assigned Team"}),(0,n.jsxs)(o.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,n.jsx)(D.Z,{sx:{fontSize:18,mr:1,color:"text.secondary"}}),(0,n.jsx)(x.Z,{variant:"body2",fontWeight:500,children:e.team_name||"N/A"})]})]}),(0,n.jsxs)(o.Z,{sx:{display:"flex",gap:1,flexWrap:"wrap"},onClick:e=>e.stopPropagation(),children:[(0,n.jsx)(Z.Z,{title:e.is_editable?"Edit goal draft":"Cannot edit goal: dependent campaigns must be ended or deleted first.",children:(0,n.jsx)("span",{children:(0,n.jsx)(h.Z,{size:"small",startIcon:(0,n.jsx)(A.Z,{}),onClick:()=>ei(e.goal_id),disabled:!e.is_editable,children:"Edit"})})}),(0,n.jsx)(h.Z,{size:"small",startIcon:(0,n.jsx)(E.Z,{}),onClick:()=>et(e.goal_id),disabled:!e.draft_version_no,children:"Publish Draft"}),(0,n.jsx)(Z.Z,{title:e.published_version_no?"":"A goal must have a published version to be cloned.",children:(0,n.jsx)("span",{children:(0,n.jsx)(h.Z,{size:"small",startIcon:(0,n.jsx)(N.Z,{}),onClick:()=>er(e.goal_id),variant:"outlined",disabled:!e.published_version_no,children:"Clone"})})}),(0,n.jsx)(h.Z,{size:"small",variant:"outlined",color:$===e.goal_id?"success":"primary",startIcon:$===e.goal_id?(0,n.jsx)(F.Z,{}):(0,n.jsx)(P.Z,{}),onClick:()=>ec(e.goal_id),children:$===e.goal_id?"Copied":"Copy ID"}),(0,n.jsx)(h.Z,{size:"small",startIcon:(0,n.jsx)(L.Z,{}),onClick:()=>el(e),color:"error",variant:"outlined",children:"Delete"})]})]})})})},e.goal_id))})]}),(0,n.jsxs)(_.Z,{open:R,onClose:()=>V(!1),maxWidth:"sm",fullWidth:!0,children:[(0,n.jsx)(w.Z,{children:"Archive Goal"}),(0,n.jsxs)(C.Z,{children:[(0,n.jsxs)(x.Z,{children:['Are you sure you want to archive the goal "',null==J?void 0:J.goal_name,'"?']}),(0,n.jsxs)(d.Z,{severity:"warning",sx:{mt:2},children:[(0,n.jsx)(k.Z,{children:"Warning"}),"Archiving this goal will remove it from active lists and disable associated campaigns."]})]}),(0,n.jsxs)(I.Z,{children:[(0,n.jsx)(h.Z,{onClick:()=>V(!1),children:"Cancel"}),(0,n.jsx)(h.Z,{onClick:en,color:"error",variant:"contained",children:"Archive Goal"})]})]})]})]})}},1637:function(e,a,t){"use strict";t.d(a,{CK:function(){return r},Cq:function(){return x},DG:function(){return u},FV:function(){return i},HZ:function(){return l},LK:function(){return h},aX:function(){return s},g3:function(){return c},qx:function(){return o},s6:function(){return d}});var n=t(4633);let s=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return(await n.Z.get("/api/v1/goals/",{params:{skip:e,limit:a}})).data},i=async()=>(await n.Z.get("/api/v1/goals/active-summary")).data,r=async(e,a)=>(await n.Z.get("/api/v1/goals/".concat(e,"/versions/").concat(a))).data,l=async e=>(await n.Z.post("/api/v1/goals/",e)).data,o=async(e,a)=>(await n.Z.put("/api/v1/goals/".concat(e,"/versions/draft"),a)).data,c=async e=>(await n.Z.put("/api/v1/goals/".concat(e,"/versions/draft/publish"))).data,d=async e=>(await n.Z.delete("/api/v1/goals/".concat(e))).data,x=async()=>(await n.Z.get("/api/v1/goals/utils/owners")).data,h=async()=>(await n.Z.get("/api/v1/goals/utils/teams")).data,u=async e=>{try{return await n.Z.get("/api/v1/goals/".concat(e,"/can_edit")),!0}catch(a){return console.error("Check for goal ".concat(e," failed, assuming it's not editable.")),!1}}}},function(e){e.O(0,[334,103,362,41,635,73,21,971,117,744],function(){return e(e.s=2279)}),_N_E=e.O()}]);