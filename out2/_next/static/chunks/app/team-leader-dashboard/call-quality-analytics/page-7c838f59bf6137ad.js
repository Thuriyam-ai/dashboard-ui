(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[883],{5451:function(e,r,n){Promise.resolve().then(n.bind(n,9816))},9816:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return ee}});var t=n(7437),a=n(2265),s=n(9376),i=n(4753),c=n(3397),l=n(8543),o=n(9083),d=n(5666),h=n(658),x=n(5545),j=n(2854),g=n(7639),Z=n(1504),m=n(5338),u=n(7893),p=n(1563),f=n(1002),y=n(9352),v=n(2347),b=n(9391),S=n(9318),w=n(5280),C=n(8319),_=n(9882),I=n(2995),z=n(8654),W=n(8045),E=n(6838),F=n(6116),N=n(6382),k=n(6875),A=n(793),L=n(1096),P=n(47),T=n(6508),B=(0,T.Z)((0,t.jsx)("path",{d:"m16 18 2.29-2.29-4.88-4.88-4 4L2 7.41 3.41 6l6 6 4-4 6.3 6.29L22 12v6z"}),"TrendingDown"),M=n(2141),O=n(1463),q=n(2192),D=n(307),R=(0,T.Z)((0,t.jsx)("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02z"}),"Phone"),U=(0,T.Z)((0,t.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"}),"Error"),J=n(7367),V=n(7306),X=n(2961),G=(0,T.Z)((0,t.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person"),H=n(4881),Q=n(6159),K=n(4633);let Y=async e=>{if(!e)throw Error("Campaign ID is required.");try{return(await K.Z.get("/api/v1/aggregations/campaigns/".concat(e,"/parameters-analysis"))).data}catch(r){throw console.error("Failed to fetch parameters analysis for campaign ".concat(e,":"),r),Error("Could not fetch campaign parameters analysis.")}},$=async e=>{if(!e)throw Error("Campaign ID is required.");try{return(await K.Z.get("/api/v1/aggregations/campaigns/".concat(e,"/agents-performance-summary"))).data}catch(r){throw console.error("Failed to fetch agent performance summary for campaign ".concat(e,":"),r),Error("Could not fetch agent performance summary.")}};function ee(){(0,s.useRouter)();let[e,r]=(0,a.useState)(null),[n,T]=(0,a.useState)("None"),[K,ee]=(0,a.useState)(""),[er,en]=(0,a.useState)(""),{logout:et}=(0,H.a)(),[ea,es]=(0,a.useState)([]),[ei,ec]=(0,a.useState)(!0),[el,eo]=(0,a.useState)(null),[ed,eh]=(0,a.useState)([]),[ex,ej]=(0,a.useState)(!1),[eg,eZ]=(0,a.useState)(null),[em,eu]=(0,a.useState)([]),[ep,ef]=(0,a.useState)(!1),[ey,ev]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{try{ec(!0);let e=await (0,Q.E6)();es(e),eo(null)}catch(e){console.error("Failed to fetch campaigns for filter:",e),eo("Could not load campaigns.")}finally{ec(!1)}})()},[]),(0,a.useEffect)(()=>{if("None"===n){eh([]),eu([]),eZ(null),ev(null);return}(async()=>{ej(!0),eZ(null),Y(n).then(e=>eh(e)).catch(e=>{console.error("Failed to fetch parameters analysis:",e),eZ("Failed to load campaign parameters analysis. Please try again.")}).finally(()=>ej(!1)),ef(!0),ev(null),$(n).then(e=>eu(e)).catch(e=>{console.error("Failed to fetch agent performance:",e),ev("Failed to load agent performance summary. Please try again.")}).finally(()=>ef(!1))})()},[n]);let eb=e=>e>=90?"success":e>=80?"warning":"error",eS=e=>"FATAL"===e.toUpperCase()?"error":"warning",ew=e=>e>=85?(0,t.jsx)(P.Z,{color:"success"}):(0,t.jsx)(B,{color:"error"});return(0,t.jsxs)(l.Z,{sx:{minHeight:"100vh",backgroundColor:"background.default"},children:[(0,t.jsx)(i.q,{activeItem:"call-quality"}),(0,t.jsxs)(l.Z,{sx:{flexGrow:1,display:"flex",flexDirection:"column",marginLeft:"280px",minHeight:"100vh"},children:[(0,t.jsx)(o.Z,{position:"static",elevation:1,sx:{backgroundColor:"background.paper",color:"text.primary",borderBottom:"1px solid",borderColor:"divider"},children:(0,t.jsxs)(d.Z,{children:[(0,t.jsx)(l.Z,{sx:{flexGrow:1},children:(0,t.jsx)(h.Z,{variant:"body2",sx:{fontFamily:"monospace",color:"text.secondary"},children:"call-quality-analytics.localhost:3000"})}),(0,t.jsxs)(l.Z,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,t.jsx)(x.Z,{size:"small",sx:{color:"text.secondary"},children:(0,t.jsx)(M.Z,{})}),(0,t.jsxs)(l.Z,{sx:{display:"flex",alignItems:"center",gap:1,mr:2},children:[(0,t.jsx)(j.Z,{sx:{width:32,height:32,bgcolor:"primary.main",fontSize:"0.875rem"},children:"W"}),(0,t.jsx)(h.Z,{variant:"body2",fontWeight:500,children:"Work"})]}),(0,t.jsx)(x.Z,{size:"small",sx:{color:"text.secondary"},children:(0,t.jsx)(O.Z,{})}),(0,t.jsx)(g.Z,{variant:"contained",color:"error",size:"small",startIcon:(0,t.jsx)(q.Z,{}),sx:{ml:1},onClick:et,children:"Logout"})]})]})}),(0,t.jsxs)(Z.Z,{maxWidth:"xl",sx:{flexGrow:1,py:3,maxWidth:"100%",overflow:"hidden"},children:[(0,t.jsx)(c.O,{}),(0,t.jsxs)(l.Z,{sx:{mb:4},children:[(0,t.jsx)(h.Z,{variant:"h3",component:"h1",fontWeight:700,gutterBottom:!0,children:"Call Quality Analytics"}),(0,t.jsx)(h.Z,{variant:"h6",color:"text.secondary",children:"Comprehensive call quality metrics and performance analysis based on WorkIndia standards"})]}),(0,t.jsxs)(m.Z,{severity:"info",sx:{mb:4},children:[(0,t.jsx)(u.Z,{children:"Scoring Rules"}),(0,t.jsxs)(h.Z,{variant:"body2",children:[(0,t.jsx)("strong",{children:"Fatal Errors:"})," Single fatal error = 30% score reduction, Multiple fatal errors = 75% score reduction",(0,t.jsx)("br",{}),(0,t.jsx)("strong",{children:"Non-Fatal Errors:"})," Single non-fatal error = 10% score reduction, Multiple non-fatal errors = 20% score reduction"]})]}),(0,t.jsx)(p.Z,{sx:{mb:4},children:(0,t.jsx)(f.Z,{children:(0,t.jsxs)(y.Z,{container:!0,spacing:2,alignItems:"center",children:[(0,t.jsxs)(y.Z,{item:!0,xs:12,md:6,children:[(0,t.jsxs)(v.Z,{fullWidth:!0,disabled:ei,children:[(0,t.jsx)(b.Z,{id:"campaign-select-label",children:"Campaign"}),(0,t.jsxs)(S.Z,{labelId:"campaign-select-label",id:"campaign-select",value:n,label:"Campaign",onChange:e=>{let r=e.target.value;if(T(r),"None"===r){ee(""),en("");return}let n=ea.find(e=>e.id===r);n?(ee(n.starts_at?n.starts_at.substring(0,10):""),en(n.ends_at?n.ends_at.substring(0,10):"")):(ee(""),en(""))},children:[(0,t.jsx)(w.Z,{value:"None",children:(0,t.jsx)("em",{children:"None"})}),ea.map(e=>(0,t.jsx)(w.Z,{value:e.id,children:e.name},e.id))]}),ei&&(0,t.jsx)(C.Z,{size:24,sx:{position:"absolute",top:"50%",right:40,marginTop:"-12px"}})]}),el&&(0,t.jsx)(h.Z,{color:"error",variant:"caption",children:el})]}),(0,t.jsx)(y.Z,{item:!0,xs:12,md:3,children:(0,t.jsx)(_.Z,{fullWidth:!0,disabled:!0,id:"start-date",label:"Start Date",value:K,InputLabelProps:{shrink:!!K}})}),(0,t.jsx)(y.Z,{item:!0,xs:12,md:3,children:(0,t.jsx)(_.Z,{fullWidth:!0,disabled:!0,id:"end-date",label:"End Date",value:er,InputLabelProps:{shrink:!!er}})})]})})}),(0,t.jsxs)(l.Z,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr",md:"1fr 1fr 1fr 1fr"},gap:3,mb:4},children:[(0,t.jsx)(p.Z,{children:(0,t.jsx)(f.Z,{children:(0,t.jsxs)(l.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,t.jsxs)(l.Z,{children:[(0,t.jsx)(h.Z,{color:"text.secondary",gutterBottom:!0,children:"Overall Score"}),(0,t.jsx)(h.Z,{variant:"h4",fontWeight:700,color:"primary",children:"87.2%"})]}),(0,t.jsx)(D.Z,{sx:{fontSize:40,color:"primary.main"}})]})})}),(0,t.jsx)(p.Z,{children:(0,t.jsx)(f.Z,{children:(0,t.jsxs)(l.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,t.jsxs)(l.Z,{children:[(0,t.jsx)(h.Z,{color:"text.secondary",gutterBottom:!0,children:"Total Calls"}),(0,t.jsx)(h.Z,{variant:"h4",fontWeight:700,color:"success.main",children:"10"})]}),(0,t.jsx)(R,{sx:{fontSize:40,color:"success.main"}})]})})}),(0,t.jsx)(p.Z,{children:(0,t.jsx)(f.Z,{children:(0,t.jsxs)(l.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,t.jsxs)(l.Z,{children:[(0,t.jsx)(h.Z,{color:"text.secondary",gutterBottom:!0,children:"Fatal Errors"}),(0,t.jsx)(h.Z,{variant:"h4",fontWeight:700,color:"error.main",children:"0"})]}),(0,t.jsx)(U,{sx:{fontSize:40,color:"error.main"}})]})})}),(0,t.jsx)(p.Z,{children:(0,t.jsx)(f.Z,{children:(0,t.jsxs)(l.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,t.jsxs)(l.Z,{children:[(0,t.jsx)(h.Z,{color:"text.secondary",gutterBottom:!0,children:"Avg Call Duration"}),(0,t.jsx)(h.Z,{variant:"h4",fontWeight:700,color:"info.main",children:"8:45"})]}),(0,t.jsx)(J.Z,{sx:{fontSize:40,color:"info.main"}})]})})})]}),(0,t.jsx)(p.Z,{sx:{mb:4},children:(0,t.jsxs)(f.Z,{children:[(0,t.jsx)(h.Z,{variant:"h5",fontWeight:600,gutterBottom:!0,sx:{mb:3},children:"Call Quality Parameters Analysis"}),(0,t.jsx)(I.Z,{component:z.Z,variant:"outlined",children:(0,t.jsxs)(W.Z,{children:[(0,t.jsx)(E.Z,{children:(0,t.jsxs)(F.Z,{children:[(0,t.jsx)(N.Z,{children:(0,t.jsx)("strong",{children:"Parameter"})}),(0,t.jsx)(N.Z,{align:"center",children:(0,t.jsx)("strong",{children:"Max Score"})}),(0,t.jsx)(N.Z,{align:"center",children:(0,t.jsx)("strong",{children:"Type"})}),(0,t.jsx)(N.Z,{align:"center",children:(0,t.jsx)("strong",{children:"Current Score"})}),(0,t.jsx)(N.Z,{align:"center",children:(0,t.jsx)("strong",{children:"Adherence %"})}),(0,t.jsx)(N.Z,{align:"center",children:(0,t.jsx)("strong",{children:"Trend"})})]})}),(0,t.jsx)(k.Z,{children:ex?(0,t.jsx)(F.Z,{children:(0,t.jsx)(N.Z,{colSpan:6,align:"center",children:(0,t.jsx)(C.Z,{})})}):eg?(0,t.jsx)(F.Z,{children:(0,t.jsx)(N.Z,{colSpan:6,children:(0,t.jsx)(m.Z,{severity:"error",children:eg})})}):0===ed.length&&"None"!==n?(0,t.jsx)(F.Z,{children:(0,t.jsx)(N.Z,{colSpan:6,align:"center",children:"No parameter data available for this campaign."})}):0===ed.length?(0,t.jsx)(F.Z,{children:(0,t.jsx)(N.Z,{colSpan:6,align:"center",children:"Select a campaign to view its parameters analysis."})}):ed.map(e=>(0,t.jsxs)(F.Z,{children:[(0,t.jsx)(N.Z,{children:(0,t.jsx)(h.Z,{variant:"body2",fontWeight:600,children:e.parameter})}),(0,t.jsx)(N.Z,{align:"center",children:(0,t.jsx)(h.Z,{variant:"body2",fontWeight:600,children:e.max_score})}),(0,t.jsx)(N.Z,{align:"center",children:(0,t.jsx)(A.Z,{label:e.type,color:eS(e.type),size:"small",icon:"FATAL"===e.type.toUpperCase()?(0,t.jsx)(V.Z,{}):(0,t.jsx)(X.Z,{})})}),(0,t.jsx)(N.Z,{align:"center",children:(0,t.jsx)(h.Z,{variant:"body2",fontWeight:600,color:"".concat(eb(e.current_score),".main"),children:e.current_score.toFixed(1)})}),(0,t.jsx)(N.Z,{align:"center",children:(0,t.jsxs)(l.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:1},children:[(0,t.jsx)(L.Z,{variant:"determinate",value:e.adherence_percentage,sx:{width:60,height:8,borderRadius:4},color:eb(e.adherence_percentage)}),(0,t.jsxs)(h.Z,{variant:"body2",fontWeight:600,children:[e.adherence_percentage,"%"]})]})}),(0,t.jsx)(N.Z,{align:"center",children:ew(e.adherence_percentage)})]},e.parameter))})]})})]})}),(0,t.jsx)(p.Z,{children:(0,t.jsxs)(f.Z,{children:[(0,t.jsx)(h.Z,{variant:"h5",fontWeight:600,gutterBottom:!0,sx:{mb:3},children:"Agent Performance Summary"}),(0,t.jsx)(I.Z,{component:z.Z,variant:"outlined",children:(0,t.jsxs)(W.Z,{children:[(0,t.jsx)(E.Z,{children:(0,t.jsxs)(F.Z,{children:[(0,t.jsx)(N.Z,{children:(0,t.jsx)("strong",{children:"Agent ID"})}),(0,t.jsx)(N.Z,{align:"center",children:(0,t.jsx)("strong",{children:"Total Score"})}),(0,t.jsx)(N.Z,{align:"center",children:(0,t.jsx)("strong",{children:"Fatal Errors"})}),(0,t.jsx)(N.Z,{align:"center",children:(0,t.jsx)("strong",{children:"Non-Fatal Errors"})}),(0,t.jsx)(N.Z,{align:"center",children:(0,t.jsx)("strong",{children:"Total Calls"})}),(0,t.jsx)(N.Z,{align:"center",children:(0,t.jsx)("strong",{children:"Status"})})]})}),(0,t.jsx)(k.Z,{children:ep?(0,t.jsx)(F.Z,{children:(0,t.jsx)(N.Z,{colSpan:6,align:"center",children:(0,t.jsx)(C.Z,{})})}):ey?(0,t.jsx)(F.Z,{children:(0,t.jsx)(N.Z,{colSpan:6,children:(0,t.jsx)(m.Z,{severity:"error",children:ey})})}):0===em.length&&"None"!==n?(0,t.jsx)(F.Z,{children:(0,t.jsx)(N.Z,{colSpan:6,align:"center",children:"No agent performance data available for this campaign."})}):0===em.length?(0,t.jsx)(F.Z,{children:(0,t.jsx)(N.Z,{colSpan:6,align:"center",children:"Select a campaign to view agent performance."})}):em.map(e=>(0,t.jsxs)(F.Z,{children:[(0,t.jsx)(N.Z,{children:(0,t.jsxs)(l.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,t.jsx)(G,{sx:{fontSize:20,color:"text.secondary"}}),(0,t.jsx)(h.Z,{variant:"body2",fontWeight:600,children:e.agent_id})]})}),(0,t.jsx)(N.Z,{align:"center",children:(0,t.jsxs)(h.Z,{variant:"body2",fontWeight:600,color:"".concat(eb(e.total_score),".main"),children:[e.total_score.toFixed(1),"%"]})}),(0,t.jsx)(N.Z,{align:"center",children:(0,t.jsx)(h.Z,{variant:"body2",fontWeight:600,color:e.fatal_errors>0?"error.main":"success.main",children:e.fatal_errors})}),(0,t.jsx)(N.Z,{align:"center",children:(0,t.jsx)(h.Z,{variant:"body2",fontWeight:600,color:e.non_fatal_errors>2?"warning.main":"success.main",children:e.non_fatal_errors})}),(0,t.jsx)(N.Z,{align:"center",children:(0,t.jsx)(h.Z,{variant:"body2",fontWeight:600,children:e.total_calls})}),(0,t.jsx)(N.Z,{align:"center",children:(0,t.jsx)(A.Z,{label:0===e.fatal_errors?"Excellent":1===e.fatal_errors?"Good":"Needs Improvement",color:0===e.fatal_errors?"success":1===e.fatal_errors?"warning":"error",size:"small"})})]},e.agent_id))})]})})]})})]})]})]})}},4633:function(e,r,n){"use strict";var t=n(3464);let a=n(257).env.NEXT_PUBLIC_API_BASE_URL||"http://thuriyam.wrkind.com:8000",s=t.Z.create({baseURL:a,headers:{"Content-Type":"application/json"}});s.interceptors.request.use(e=>{let r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ0ZXN0dXNlciIsInNjb3BlcyI6WyJtZSIsInVzZXJzIiwiYWRtaW4iXSwiZXhwIjoxNzU4ODcyNzExfQ.R_90bqCS7yw9qjFS0jzx1FcSca1POM8dQ2ATSmHOR_0";return r&&(e.headers.Authorization="Bearer ".concat(r)),e},e=>Promise.reject(e)),r.Z=s},6159:function(e,r,n){"use strict";n.d(r,{E6:function(){return a},QF:function(){return i},bO:function(){return s},hm:function(){return l},mK:function(){return c}});var t=n(4633);let a=async function(){let{skip:e=0,limit:r=100}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return(await t.Z.get("/api/v1/campaigns/",{params:{skip:e,limit:r}})).data}catch(e){throw console.error("Failed to fetch campaigns:",e),Error("Could not fetch campaigns.")}},s=async e=>{try{await t.Z.delete("/api/v1/campaigns/".concat(e))}catch(r){throw console.error("Failed to delete campaign ".concat(e,":"),r),Error("Could not delete the campaign.")}},i=async e=>{try{return(await t.Z.get("/api/v1/campaigns/".concat(e))).data}catch(r){throw console.error("Failed to fetch campaign ".concat(e,":"),r),Error("Could not fetch campaign details.")}},c=async e=>{try{return(await t.Z.post("/api/v1/campaigns/",e)).data}catch(e){throw console.error("Failed to create campaign:",e),Error("Could not create campaign.")}},l=async(e,r)=>{try{return(await t.Z.put("/api/v1/campaigns/".concat(e),r)).data}catch(r){throw console.error("Failed to update campaign ".concat(e,":"),r),Error("Could not update campaign.")}}},307:function(e,r,n){"use strict";var t=n(6508),a=n(7437);r.Z=(0,t.Z)((0,a.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M9 17H7v-7h2zm4 0h-2V7h2zm4 0h-2v-4h2z"}),"Assessment")},47:function(e,r,n){"use strict";var t=n(6508),a=n(7437);r.Z=(0,t.Z)((0,a.jsx)("path",{d:"m16 6 2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"}),"TrendingUp")},7306:function(e,r,n){"use strict";var t=n(6508),a=n(7437);r.Z=(0,t.Z)((0,a.jsx)("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}),"Warning")}},function(e){e.O(0,[152,56,855,668,815,304,882,4,611,135,2,971,117,744],function(){return e(e.s=5451)}),_N_E=e.O()}]);